apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: image-digest
spec:
  params:
  - name: image
    type: string
  - name: skopeo-image
    type: string
    default: registry.redhat.io/rhel8/skopeo@sha256:6d20ab55415a1a0ca198ffa3be2dac82d19526ab3a290fa2fa5c8d2c5d2eefd0
  results:
  - name: digest
    description: The digest of the given image
  steps:
  - name: inspect
    image: $(params.skopeo-image)
    script: |
      skopeo inspect $(params.image) --format "{{.Digest}}" | tee '$(results.digest.path)'
